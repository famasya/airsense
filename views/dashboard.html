<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>AirSense Dashboard</title>
	<meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
	<meta name="description" content="Developed By M Abdur Rokib Promy">
	<meta name="keywords" content="Admin, Bootstrap 3, Template, Theme, Responsive">
	<link href="views/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<link href="views/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
	<link href="views/css/ionicons.min.css" rel="stylesheet" type="text/css" />
	<link href="views/css/jvectormap/jquery-jvectormap-1.2.2.css" rel="stylesheet" type="text/css" />
	<link href="views/css/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />
	<link href="views/css/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css" />
	<link href="views/css/iCheck/all.css" rel="stylesheet" type="text/css" />
	<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
	<link href="views/css/style.css" rel="stylesheet" type="text/css" />
	<style type="text/css">
	</style>
</head>
<body class="skin-black">
	<header class="header">
		<a href="dashboard" class="logo">
			Dashboard
		</a>
		<nav class="navbar navbar-static-top" role="navigation">
			<a href="#" class="navbar-btn sidebar-toggle" data-toggle="offcanvas" role="button">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</a>
			<div class="navbar-right">
				<ul class="nav navbar-nav">
					<li class="dropdown user user-menu">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">
							<i class="fa fa-user"></i>
							<span>User<i class="caret"></i></span>
						</a>
						<ul class="dropdown-menu dropdown-custom dropdown-menu-right">
							<li class="dropdown-header text-center">Account</li>
							<li>
								<a href="#">
									<i class="fa fa-clock-o fa-fw pull-right"></i>
									<span class="badge badge-success pull-right">10</span> Updates</a>
									<a href="#">
										<i class="fa fa-envelope-o fa-fw pull-right"></i>
										<span class="badge badge-danger pull-right">5</span> Messages</a>
										<a href="#"><i class="fa fa-magnet fa-fw pull-right"></i>
											<span class="badge badge-info pull-right">3</span> Subscriptions</a>
											<a href="#"><i class="fa fa-question fa-fw pull-right"></i> <span class=
												"badge pull-right">11</span> FAQ</a>
											</li>
											<li class="divider"></li>
											<li>
												<a href="#">
													<i class="fa fa-user fa-fw pull-right"></i>
													Profile
												</a>
												<a data-toggle="modal" href="#modal-user-settings">
													<i class="fa fa-cog fa-fw pull-right"></i>
													Settings
												</a>
											</li>
											<li class="divider"></li>
											<li>
												<a href="#"><i class="fa fa-ban fa-fw pull-right"></i> Logout</a>
											</li>
										</ul>
									</li>
								</ul>
							</div>
						</nav>
					</header>
					<div class="wrapper row-offcanvas row-offcanvas-left">
						<aside class="left-side sidebar-offcanvas">
							<section class="sidebar">
								<div class="user-panel">
									<div class="pull-left image">
										<img src="views/img/26115.jpg" class="img-circle" alt="User Image" />
									</div>
									<div class="pull-left info">
										<p>Hello</p>
										<a href="#"><i class="fa fa-circle text-success"></i> Online</a>
									</div>
								</div>
								<form action="#" method="get" class="sidebar-form">
									<div class="input-group">
										<input type="text" name="q" class="form-control" placeholder="Search..."/>
										<span class="input-group-btn">
											<button type='submit' name='seach' id='search-btn' class="btn btn-flat"><i class="fa fa-search"></i></button>
										</span>
									</div>
								</form>
								<ul class="sidebar-menu">
									<li class="active">
										<a href="dashboard">
											<i class="fa fa-dashboard"></i> <span>Dashboard</span>
										</a>
									</li>
									<li>
										<a href="family">
											<i class="fa fa-users"></i> <span>Family</span>
										</a>
									</li>
									<li>
										<a href="messege">
											<i class="fa fa-gear"></i> <span>Messeges</span>
										</a>
									</li>
									<li>
										<a href="help">
											<i class="fa fa-info"></i> <span>Help</span>
										</a>
									</li>
								</ul>
							</section>
						</aside>
						<aside class="right-side">
							<section class="content">
								<div class="row">
									<div class="col-md-4">
										<div class="sm-st clearfix">
											<span class="sm-st-icon st-red"><i class="fa fa-chevron-circle-up"></i></span>
											<div class="sm-st-info">
												<a href="notifications"><span class="attention">0 events</span></a>
												Need attentions
											</div>
										</div>
									</div>
									<div class="col-md-4">
										<div class="sm-st clearfix">
											<span class="sm-st-icon st-green"><i class="fa fa-chevron-circle-down"></i></span>
											<div class="sm-st-info">
												<span class="dustlevel">Clean</span>
												Dust level at your home
											</div>
										</div>
									</div>
									<div class="col-md-4">
										<div class="sm-st clearfix">
											<span class="sm-st-icon st-blue"><i class="fa fa-cloud"></i></span>
											<div class="sm-st-info">
												<span class="temperature">{{temperature}} C</span>
												{{weather}}, {{weather_desc}}
											</div>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-md-6">
										<section class="panel">
											<header class="panel-heading">
												AirSense Temperature Graph
											</header>
											<div class="panel-body">
												<div id="temp-realtime" style="height: 300px"></div>
											</div>
										</section>
									</div>
									<div class="col-md-6">
										<section class="panel">
											<header class="panel-heading">
												AirSense Humidity Graph
											</header>
											<div class="panel-body">
												<div id="humid-realtime" style="height: 300px"></div>
											</div>
										</section>
									</div>
								</div>
							</section>
							<div class="footer-main">
								Copyright &copy AirSense, 2014
							</div>
						</aside>
					</div>
					<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
					<script src="views/js/jquery.min.js" type="text/javascript"></script>
					<script src="views/js/jquery-ui-1.10.3.min.js" type="text/javascript"></script>
					<script src="views/js/bootstrap.min.js" type="text/javascript"></script>
					<script src="views/js/plugins/daterangepicker/daterangepicker.js" type="text/javascript"></script>
					<script src="views/js/plugins/chart.js" type="text/javascript"></script>
					<script src="views/js/plugins/iCheck/icheck.min.js" type="text/javascript"></script>
					<script src="views/js/plugins/fullcalendar/fullcalendar.js" type="text/javascript"></script>
					<script src="views/js/AirSense/app.js" type="text/javascript"></script>
					<script src="views/js/AirSense/dashboard.js" type="text/javascript"></script>
					<script src="http://code.highcharts.com/highcharts.js"></script>
					<script src="http://code.highcharts.com/modules/exporting.js"></script>
					<script type="text/javascript">
						$('input').on('ifChecked', function(event) {
							$(this).parents('li').addClass("task-done");
							console.log('ok');
						});
						$('input').on('ifUnchecked', function(event) {
							$(this).parents('li').removeClass("task-done");
							console.log('not');
						});

					</script>
					<script>
						$('#noti-box').slimScroll({
							height: '400px',
							size: '5px',
							BorderRadius: '5px'
						});

						$('input[type="checkbox"].flat-grey, input[type="radio"].flat-grey').iCheck({
							checkboxClass: 'icheckbox_flat-grey',
							radioClass: 'iradio_flat-grey'
						});
					</script>
					<script src="/socket.io/socket.io.js"></script>
					<script type="text/javascript">
						var tempseries,humidseries;
						$(document).ready(function () {
							Highcharts.setOptions({
								global: {
									useUTC: false
								}
							});
							$('#temp-realtime').highcharts({
								chart: {
									type: 'spline',
									animation: Highcharts.svg, 
									marginRight: 10,
									events: {
										load: function () {
											tempseries = this.series;
										}
									}
								},
								title: {
									text: 'Live data'
								},
								xAxis: {
									type: 'datetime',
									tickPixelInterval: 150
								},
								yAxis: {
									title: {
										text: 'Value'
									},
									plotLines: [{
										value: 0,
										width: 1,
										color: '#808080'
									}]
								},
								tooltip: {
									formatter: function () {
										return '<b>' + this.series.name + '</b><br/>' +
										Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
										Highcharts.numberFormat(this.y, 2);
									}
								},
								legend: {
									enabled: false
								},
								exporting: {
									enabled: false
								},
								series: [
								{
									name: 'Indoor Temperature',
									data: (function () {
										var data = [],time = (new Date()).getTime(),i;
										for (i = -5; i <= 0; i += 1) {
											data.push({
												x: time + i * 1000,
												y: 0
											});
										}
										return data;
									}())
								},
								{
									name: 'Outdoor temperature',
									data: (function () {
										var data = [],time = (new Date()).getTime(),i;
										for (i = -5; i <= 0; i += 1) {
											data.push({
												x: time + i * 1000,
												y: 0
											});
										}
										return data;
									}())
								}
								]
							});
$('#humid-realtime').highcharts({
	chart: {
		type: 'spline',
		animation: Highcharts.svg, 
		marginRight: 10,
		events: {
			load: function () {
				humidseries = this.series;
			}
		}
	},
	title: {
		text: 'Live data'
	},
	xAxis: {
		type: 'datetime',
		tickPixelInterval: 150
	},
	yAxis: {
		title: {
			text: 'Value'
		},
		plotLines: [{
			value: 0,
			width: 1,
			color: '#808080'
		}]
	},
	tooltip: {
		formatter: function () {
			return '<b>' + this.series.name + '</b><br/>' +
			Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
			Highcharts.numberFormat(this.y, 2);
		}
	},
	legend: {
		enabled: false
	},
	exporting: {
		enabled: false
	},
	series: [
	{
		name: 'Indoor Humidity',
		data: (function () {
			var data = [],time = (new Date()).getTime(),i;
			for (i = -5; i <= 0; i += 1) {
				data.push({
					x: time + i * 1000,
					y: 0
				});
			}
			return data;
		}())
	},
	{
		name: 'Outdoor humidity',
		data: (function () {
			var data = [],time = (new Date()).getTime(),i;
			for (i = -5; i <= 0; i += 1) {
				data.push({
					x: time + i * 1000,
					y: 0
				});
			}
			return data;
		}())
	}
	]
});
});
var socket = io.connect('http://localhost:3000');
var notif_count = {{notif_count}}
socket.on('data',function(data){
	console.log(data);
	var dust = Math.abs(parseFloat(data.dust)*100);
	if(dust < 5){
		$('.dustlevel').html("Clean")      
	} 
	else if(dust > 5 && dust < 10){
		$('.dustlevel').html("Relatively dusty")
	}
	else if(dust>10 && dust < 20){
		$('.dustlevel').html("Little dusty")
	} else if(dust > 20 && dust < 50){
		$('.dustlevel').html("Average dusty")      
	} else if(dust>50){
		$('.dustlevel').html("Extremely dusty")            
	}
	$('.attention').html(notif_count+' events')
	tempseries[0].addPoint([data.x, parseInt(data.y)],false,true)
	tempseries[1].addPoint([data.x, {{temperature}}],true,true)
	humidseries[0].addPoint([data.x, parseInt(data.humid)],false,true)
	humidseries[1].addPoint([data.x, {{humid}}],true,true)
})
socket.on('notif', function(data){
	$('.attention').html((notif_count++)+' events')  
})
</script>
</body>
</html>